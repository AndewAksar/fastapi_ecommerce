{% extends "admin/base.html" %}
{% block title %}Пользователи{% endblock %}
{% block content %}
<div class="card">
  <h1>Пользователи</h1>
  <p>Добавляйте новых пользователей и управляйте существующими через формы ниже.</p>
</div>

<div class="card">
  <h2>Добавить пользователя</h2>
  <form method="post" action="/admin/users">
    <label>
      <span>Имя</span>
      <input type="text" name="first_name" value="{{ form_data.first_name if form_data else '' }}" required>
    </label>
    <label>
      <span>Фамилия</span>
      <input type="text" name="last_name" value="{{ form_data.last_name if form_data else '' }}" required>
    </label>
    <label>
      <span>Логин</span>
      <input type="text" name="username" value="{{ form_data.username if form_data else '' }}" required>
    </label>
    <label>
      <span>Email</span>
      <input type="email" name="email" value="{{ form_data.email if form_data else '' }}" required>
    </label>
    <label>
      <span>Пароль</span>
      <input type="password" name="password" required>
    </label>
    <label>
      <input type="checkbox" name="is_active" value="true" {% if form_data is none or form_data.is_active %}checked{% endif %}>
      Активен
    </label>
    <label>
      <input type="checkbox" name="is_admin" value="true" {% if form_data and form_data.is_admin %}checked{% endif %}>
      Администратор
    </label>
    <label>
      <input type="checkbox" name="is_supplier" value="true" {% if form_data and form_data.is_supplier %}checked{% endif %}>
      Поставщик
    </label>
    <label>
      <input type="checkbox" name="is_customer" value="true" {% if form_data is none or form_data.is_customer %}checked{% endif %}>
      Покупатель
    </label>
    <button type="submit" class="button primary">Создать</button>
  </form>
</div>

<div class="card">
  <h2>Список пользователей</h2>
  {% if users %}
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Имя</th>
          <th>Фамилия</th>
          <th>Логин</th>
          <th>Email</th>
          <th>Статусы</th>
          <th>Действия</th>
        </tr>
      </thead>
      <tbody>
      {% for user in users %}
        <tr>
          <td>{{ user.id }}</td>
          <td>{{ user.first_name or "—" }}</td>
          <td>{{ user.last_name or "—" }}</td>
          <td>{{ user.username }}</td>
          <td>{{ user.email }}</td>
          <td>
            <div>Активен: {{ "да" if user.is_active else "нет" }}</div>
            <div>Админ: {{ "да" if user.is_admin else "нет" }}</div>
            <div>Поставщик: {{ "да" if user.is_supplier else "нет" }}</div>
            <div>Покупатель: {{ "да" if user.is_customer else "нет" }}</div>
          </td>
          <td>
            <a class="button link" href="/admin/users/{{ user.id }}/edit">Редактировать</a>
            <form class="inline" method="post" action="/admin/users/{{ user.id }}/delete">
              <button type="submit" class="button danger" onclick="return confirm('Удалить пользователя {{ user.username }}?');">Удалить</button>
            </form>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>Пользователи не найдены.</p>
  {% endif %}
</div>
{% endblock %}
